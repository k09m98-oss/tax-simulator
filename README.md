# 法人税金・社会保険・消費税 簡易シミュレーター

日本法人向けの税金・社会保険・消費税を考慮した「実質キャッシュ残高」までを可視化する意思決定支援Webアプリです。

## 🎯 プロジェクト概要

営業利益だけでなく、**消費税**、**法人税等**、**社保会社負担**を考慮し、**税込ベースでの実際のキャッシュフロー**を正確にシミュレーションできます。

## ⚡ 重要な特徴

- ✅ **正確なキャッシュフロー計算**: 税込売上（実際の入金額）ベースで計算
- ✅ **P/Lとキャッシュフローの分離**: 税抜損益と税込キャッシュを同時表示
- ✅ **人件費の詳細化**: 役員報酬・給与・外注費を個別管理
- ✅ **社会保険料の自動計算**: 役員報酬・給与それぞれに社保料率を設定
- ✅ **複数社対応**: グループ内の複数法人を一括管理
- ✅ **グループ合算ビュー**: 全社の合計を単純合算で表示
- ✅ **パーセント入力**: 売上比率での入力が可能
- ✅ **リアルタイム計算**: 入力と同時に結果が更新
- ✅ **ローカル保存**: ブラウザを閉じてもデータが残る
- ✅ **レスポンシブデザイン**: PC・タブレット・スマホ対応

## 📊 現在完成している機能

### 1. 会社管理機能
- ✅ 会社の追加・削除（最低1社は残す）
- ✅ 会社名の編集（インライン編集）
- ✅ 会社リストからの選択・切り替え
- ✅ 会社カードにミニKPI表示（営業利益、税引後利益、キャッシュ残）

### 2. 入力機能（会社ごと）
- ✅ **前提条件トグル**
  - 課税事業者 / 免税事業者
  - インボイス登録：あり / なし
- ✅ **数値入力（税抜）**
  - 売上
  - 人件費
  - その他販管費（インボイスあり）
  - その他販管費（インボイスなし）
- ✅ **社保会社負担の扱い**
  - 人件費に含める / 別表示する（トグル）
  - 別表示時は社保会社負担を手入力

### 3. 計算機能（会社ごと）
- ✅ **営業利益**: 売上 − 人件費 − 販管費
- ✅ **消費税納付額**: (売上×10%) − (インボイスあり販管費×10%)
  - 課税事業者のみ計算、免税事業者は0円
- ✅ **法人税等**: max(0, 営業利益) × 30%（実効税率）
  - 赤字の場合は0円
- ✅ **税引後利益**: 営業利益 − 法人税等
- ✅ **実質キャッシュ残**: 税引後利益 − 消費税 − 社保会社負担（別表示時）

### 4. グループ合算機能
- ✅ 全社のKPIを単純合計
- ✅ グループ合算ビューのON/OFF切り替え
- ✅ 強調表示（青グラデーションカード）
- ✅ 大きなフォントで見やすく表示

### 5. 結果表示機能
- ✅ **KPIカード表示**
  - 営業利益
  - 消費税納付額
  - 法人税等
  - 税引後利益
  - 実質キャッシュ残
- ✅ プラス/マイナスで色分け（緑/赤）
- ✅ カンマ区切りの通貨フォーマット

### 6. UX機能
- ✅ 年度選択（2025 / 2026）
- ✅ リアルタイム更新（入力即反映）
- ✅ ローカルストレージ自動保存
- ✅ 新規グループ作成ボタン
- ✅ リセットボタン
- ✅ 確認ダイアログ（削除・リセット時）

### 7. デザイン
- ✅ モダンなカードUI
- ✅ ネイビー×ブルー×ホワイトのカラースキーム
- ✅ グラデーション背景
- ✅ シャドウとホバーエフェクト
- ✅ レスポンシブレイアウト（スマホ対応）
- ✅ カスタムスクロールバー

## 🚀 使い方

### 基本操作

1. **会社を追加**
   - ヘッダーの「+ 会社追加」ボタンをクリック
   - 新しい会社カードが左カラムに追加されます

2. **会社を選択**
   - 左カラムの会社カードをクリック
   - 中央の入力フォームが切り替わります

3. **データ入力**
   - 中央カラムで各項目を入力
   - 入力と同時に右カラムの結果が更新されます

4. **結果確認**
   - 右カラムで個社のKPIを確認
   - 「グループ合算」ボタンをONにすると全社合計を表示

5. **データ保存**
   - 入力データは自動的にブラウザに保存されます
   - リロードしてもデータは残ります

### 画面構成

```
┌─────────────────────────────────────────────────┐
│  ヘッダー（年度選択、ボタン類）                  │
├───────┬─────────────────────┬───────────────────┤
│ 左    │ 中央                │ 右                │
│ カラム│ カラム              │ カラム            │
│       │                     │                   │
│ 会社  │ 入力フォーム        │ グループ合算KPI   │
│ リスト│ (選択中の会社)      │                   │
│       │                     │ 個社KPI           │
│       │                     │                   │
└───────┴─────────────────────┴───────────────────┘
```

## 📁 ファイル構成

```
index.html              # メインファイル（React + Tailwind CSS）
README.md               # このファイル
```

## 🛠️ 技術スタック

- **React 18** (CDN版)
- **Tailwind CSS** (CDN版)
- **Babel Standalone** (JSX変換)
- **LocalStorage API** (データ永続化)

## 📋 計算ロジック詳細

### 🔵 損益計算（税抜ベース）- P/L

#### 営業利益
```
営業利益 = 売上（税抜） − 人件費合計 − 販管費合計
人件費合計 = 役員報酬 + 給与 + 外注費（インボイスあり＋なし）
販管費合計 = 販管費（インボイスあり＋なし）
```

#### 法人税等（中小企業者向け・資本金1億円以下）
```
【法人税】
・課税所得800万円以下: 15.0%
・課税所得800万円超: 23.2%

【地方法人税】
・法人税額の10.3%

【法人事業税】
・課税所得400万円以下: 3.5%
・課税所得400万円超800万円以下: 5.3%
・課税所得800万円超: 7.0%

【特別法人事業税】
・法人事業税額の37.0%

【法人住民税】
・所得割: 法人税額の7.0%
・均等割: 70,000円

法人税等合計 = 法人税 + 地方法人税 + 法人事業税 + 特別法人事業税 + 法人住民税

※ 赤字の場合は均等割70,000円のみ
```

#### 税引後利益
```
税引後利益 = 営業利益 − 法人税等
```

### 💰 消費税計算

```
預かり消費税 = 売上（税抜） × 10%
支払消費税 = (販管費インボイスあり × 10%) + (外注費インボイスあり × 10%)
           + (販管費インボイスなし × 10% × 経過措置率) + (外注費インボイスなし × 10% × 経過措置率)
消費税納付額 = 預かり消費税 − 支払消費税

※ 課税事業者のみ計算。免税事業者は0円
※ 人件費（役員報酬・給与）は消費税の対象外
※ 免税事業者等からの仕入れは経過措置に基づき一部控除可能（図表1参照）
```

#### 免税事業者等からの仕入れにおける経過措置（図表1）

| 期間 | 控除率 |
|------|--------|
| 2023/10/1～2026/9/30 | **80%** 控除可能 |
| 2026/10/1～2029/9/30 | **50%** 控除可能 |
| 2029/10/1～ | 控除不可 |

### 💵 キャッシュフロー計算（税込ベース）

```
【キャッシュイン】
税込売上 = 売上（税抜） × 1.1

【キャッシュアウト】
1. 人件費（非課税なのでそのまま）
2. 販管費（税込） = 販管費（税抜） × 1.1
3. 外注費（税込） = 外注費（税抜） × 1.1
4. 法人税
5. 消費税納付額
6. 社会保険料（別表示の場合のみ）

実質キャッシュ残高 = 税込売上 
                   − 人件費 
                   − 販管費（税込） 
                   − 外注費（税込）
                   − 法人税 
                   − 消費税納付 
                   − 社保
```

### 📊 社会保険料計算

```
役員報酬の社保 = 役員報酬 × 役員社保料率（デフォルト15%）
給与の社保 = 給与 × 給与社保料率（デフォルト15%）
社保合計 = 役員報酬の社保 + 給与の社保
```

### 🔗 グループ合算
```
各KPIを全社分単純合計
```

## 💡 重要ポイント

1. **P/L（損益計算書）は税抜ベース** で計算
2. **キャッシュフローは税込ベース** で計算（実際の入出金）
3. **消費税は預かり金** として扱い、二重控除しない
4. **人件費は非課税** なので消費税計算の対象外
5. **実質キャッシュ残高 = 実際に手元に残る現金** を表示

## 🎨 デザインコンセプト

- **色使い**: ネイビー（ヘッダー）、ブルー（アクセント）、ホワイト（背景）
- **フォント**: システムフォント（Segoe UI、游ゴシック等）
- **カード**: シャドウとラウンド角で立体感
- **数値表示**: 大きく見やすく、プラス/マイナスで色分け

## ⚠️ 注意事項

- このシミュレーターは**概算計算用**です
- 実際の税務計算は税理士にご相談ください
- 簡易課税制度、中間納付、地方税等は考慮していません
- 社会保険料率は自動計算していません（手入力）

## 🔮 今後の拡張案（未実装）

### 機能追加候補

- [ ] **詳細計算モード**
  - 簡易課税制度対応
  - 中間納付の考慮
  - 地方税の内訳表示

- [ ] **社会保険料自動計算**
  - 従業員数・平均給与からの自動算出
  - 健康保険・厚生年金の料率設定

- [ ] **CSV エクスポート**
  - 入力データと結果をCSV出力
  - 複数年度の比較データ出力

- [ ] **グラフ表示**
  - Chart.js による可視化
  - 会社間比較チャート
  - 年度推移グラフ

- [ ] **シナリオ比較**
  - 複数のシナリオを保存
  - シナリオ間の差分表示

- [ ] **印刷最適化**
  - PDF出力用レイアウト
  - レポート形式での出力

## 📝 開発メモ

### ローカルストレージキー
```
tax_simulator_data_v1
```

### データ構造
```javascript
{
  year: 2025,
  companies: [
    {
      id: 1,
      name: "会社1",
      isTaxable: true,
      hasInvoice: true,
      revenue: 0,
      laborCost: 0,
      expenseWithInvoice: 0,
      expenseWithoutInvoice: 0,
      includeSocialInsurance: true,
      socialInsuranceCost: 0
    }
  ],
  selectedCompanyId: 1,
  showGroupView: true,
  nextId: 2
}
```

## 📞 サポート

このシミュレーターは意思決定支援ツールです。正確な税務申告については必ず税理士にご相談ください。

---

**Version**: 1.0.0  
**Last Updated**: 2026-02-27  
**License**: MIT